const populateChuckFacts=function(facts){$("#num-of-facts").text(facts.length);const area=$("#chuck-facts-area");for(let fact of facts)area.append(`<section class='chuck-fact' data-factid='${fact.id}' data-description='${fact.description}'>
                 <p>${fact.description}</p>
            </section>`);$("#chuck-facts-area .chuck-fact").on("click",function(){const clickedElement=$(this),className="chuck-fact-selected",isAlreadySelected=clickedElement.hasClass(className),factId=clickedElement.data("factid"),factdescription=clickedElement.data("description"),indexedDb=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB||window.shimIndexedDB;let open=indexedDb.open("ChuckNorris",1);open.onupgradeneeded=function(){let db=open.result;db.createObjectStore("FavoriteFacts",{keyPath:"id"})};open.onsuccess=function(){const db=open.result,tx=db.transaction("FavoriteFacts","readwrite"),store=tx.objectStore("FavoriteFacts");isAlreadySelected?store.delete(factId).onsuccess=()=>{clickedElement.removeClass(className)}:(store.put({id:factId,description:factdescription}).onsuccess=()=>{clickedElement.addClass(className)},tx.oncomplete=function(){db.close()})}})},loadChuckFacts=function(){$.get(`${chuckNorrisAppSettings.apiBaseUrl}/facts`).done(populateChuckFacts).fail(function(jqXhr,textStatus,errorThrown){console.error(errorThrown)}).always(()=>{$("#loader").hide()})};$(document).ready(function(){loadChuckFacts();$("#refresh-icon").on("click",loadChuckFacts)});